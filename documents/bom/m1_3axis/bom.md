# M1 3軸TDM 部品リスト（BOM）

## 概要

3軸TDMディスクリート実装用の部品リスト（M0からの追加分）

**M1追加機能**: LIS3DH（3軸加速度センサー）によるHemispheric ambiguity解決

---

## M0で購入済み部品からの流用

| 秋月コード | 商品名 | M0残り | M1使用 | 備考 |
|------------|--------|--------|--------|------|
| [109848](https://akizukidenshi.com/catalog/g/g109848/) | DRV8835モジュール | 1 | 1 | 3軸駆動（計2枚で4ch→3ch使用） |
| [116187](https://akizukidenshi.com/catalog/g/g116187/) | MCP6022-I/P | 1 | 1 | 残り2ch（+増幅2ch分） |
| [116877](https://akizukidenshi.com/catalog/g/g116877/) | 10kΩ 0.1% | 7 | 2 | Rf追加分 |
| [116876](https://akizukidenshi.com/catalog/g/g116876/) | 1kΩ 0.1% | 9 | 2 | Rg追加分 |
| [108045](https://akizukidenshi.com/catalog/g/g108045/) | 47pF C0G | 9 | 2 | 発振防止追加分 |
| [117059](https://akizukidenshi.com/catalog/g/g117059/) | 0.1µF C0G | 6 | 2 | デカップリング追加分 |
| [105002](https://akizukidenshi.com/catalog/g/g105002/) | 100µF電解 | 3 | 1 | DRV8835 #2用 |

### コイル（追加購入不要）

| 入手先 | 商品名 | M0残り | M1使用 | 備考 |
|--------|--------|--------|--------|------|
| AliExpress | 3D11-722J 3軸コイル | **3** | 2 | 送信Y/Z軸用（各1個）または受信Y/Z軸用 |

---

## M1で追加購入が必要な部品

### LIS3DH（3軸加速度センサー）— Hemispheric Ambiguity解決用

| 入手先 | 商品名 | 価格 | 数量 | 備考 |
|--------|--------|------|------|------|
| 秋月電子 | LIS3DHモジュール | 約¥500 | 1 | ブレッドボード対応推奨 |
| AliExpress | GY-LIS3DH | 約$2-3 | 1 | 安価だが配送時間あり |
| Adafruit | LIS3DH Breakout | 約$8 | 1 | 品質安定、ライブラリ充実 |

**LIS3DH仕様**:
- メーカー: STMicroelectronics
- 電源電圧: 1.71V〜3.6V
- インターフェース: I2C / SPI
- I2Cアドレス: 0x18（SA0=GND）または 0x19（SA0=VDD）
- 消費電力: 超低消費（2µA @ 1Hz）
- データシート: `documents/requirements/lis3dh/lis3dh.pdf`

**接続（I2C）**:

| LIS3DH | XIAO ESP32C3 | GPIO |
|--------|--------------|------|
| SDA | D4 | GPIO6 |
| SCL | D5 | GPIO7 |
| VDD | 3.3V | - |
| GND | GND | - |
| SA0 | GND | - （アドレス0x18） |

**追加部品（ブレークアウトボードに内蔵の場合は不要）**:

| 部品 | 値 | 数量 | 用途 |
|------|-----|------|------|
| プルアップ抵抗 | 4.7kΩ | 2 | I2C SDA, SCL |

---

### 送信コイル（3D11-722Jから流用）

| 品名 | 仕様 | 数量 | 用途 | 備考 |
|------|------|------|------|------|
| 送信コイル Y軸 | 3D11-722J | 1 | Y軸磁界生成 | M0残りから流用 |
| 送信コイル Z軸 | 3D11-722J | 1 | Z軸磁界生成 | M0残りから流用 |
| 共振C Y軸 | 最適値 | 1セット | Y軸波形整形 | M0で最適値確定後 |
| 共振C Z軸 | 最適値 | 1セット | Z軸波形整形 | M0で最適値確定後 |

### 受信コイル（3D11-722Jから流用）

| 品名 | 仕様 | 数量 | 用途 | 備考 |
|------|------|------|------|------|
| 受信コイル Y軸 | 3D11-722J | 1 | Y軸誘導電圧検出 | M0残りから流用 |
| 受信コイル Z軸 | 3D11-722J | 1 | Z軸誘導電圧検出 | M0残りから流用 |

### 3軸コイル候補

| タイプ | 仕様 | メリット | デメリット |
|--------|------|----------|------------|
| 3Dコイル（市販） | 直交3軸一体型 | 位置精度高い | 入手性、サイズ制約 |
| 立方体巻線（自作） | 50mm立方体、各面に巻線 | カスタマイズ可 | 製作手間 |
| 個別コイル3個配置 | 独立コイル×3 | 簡単 | 位置合わせ困難 |

---

## M1完成時の総部品使用数

| 部品 | M0 | M1追加 | 合計 | 在庫残り |
|------|-----|--------|------|----------|
| XIAO ESP32C3 | 1 | 0 | 1 | 1 |
| DRV8835モジュール | 1 | 1 | 2 | 0 |
| MCP6022 | 1 | 1 | 2（計4ch） | 0 |
| MCP3008 | 1 | 0 | 1（3ch使用） | 0 |
| 3D11-722J | 2 | 2 | 4 | **1** |
| **LIS3DH** | 0 | **1** | **1** | - |
| 10kΩ (Rf) | 1 | 2 | 3 | 7 |
| 1kΩ (Rg) | 1 | 2 | 3 | 9 |
| 47pF | 1 | 2 | 3 | 9 |
| 4.7kΩ（I2Cプルアップ） | 0 | 2 | 2 | - |

---

## GPIO割り当て（3軸時）

※ ESP32S3の型番確定後に詳細化

### 送信側

| 機能 | DRV8835 | GPIO | 備考 |
|------|---------|------|------|
| PWM_X | #1 AIN1 | TBD | X軸送信 |
| PWM_X_INV | #1 AIN2 | TBD | X軸反転PWM |
| PWM_Y | #1 BIN1 | TBD | Y軸送信 |
| PWM_Y_INV | #1 BIN2 | TBD | Y軸反転PWM |
| PWM_Z | #2 AIN1 | TBD | Z軸送信 |
| PWM_Z_INV | #2 AIN2 | TBD | Z軸反転PWM |

### 受信側

| 機能 | MCP3008 CH | 備考 |
|------|------------|------|
| RX_X | CH0 | X軸受信 |
| RX_Y | CH1 | Y軸受信 |
| RX_Z | CH2 | Z軸受信 |

### SPI（共通）

| 信号 | GPIO | 備考 |
|------|------|------|
| SPI_CLK | GPIO8 (D8) | MCP3008 CLK |
| SPI_MOSI | GPIO10 (D10) | MCP3008 DIN |
| SPI_MISO | GPIO9 (D9) | MCP3008 DOUT |
| SPI_CS | GPIO20 (D7) | MCP3008 CS |

### I2C（LIS3DH用）

| 信号 | GPIO | 備考 |
|------|------|------|
| I2C_SDA | GPIO6 (D4) | LIS3DH SDA |
| I2C_SCL | GPIO7 (D5) | LIS3DH SCL |

---

## DRV8835 2枚構成

### DRV8835 #1（M0から使用）

| 出力 | 接続先 |
|------|--------|
| AOUT1/2 | X軸送信コイル |
| BOUT1/2 | Y軸送信コイル |

### DRV8835 #2（M1で追加）

| 出力 | 接続先 |
|------|--------|
| AOUT1/2 | Z軸送信コイル |
| BOUT1/2 | 未使用 |

---

## MCP6022 2枚構成

### MCP6022 #1（M0から使用）

| チャンネル | 用途 |
|------------|------|
| A | Vmidバッファ |
| B | X軸受信アンプ |

### MCP6022 #2（M1で追加）

| チャンネル | 用途 |
|------------|------|
| A | Y軸受信アンプ |
| B | Z軸受信アンプ |
